<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>マニフェストファイルのサイドロード | ITブログ @ GB</title>
    <meta name="description" content="”Office Add-in”をつくるにあたって、開発用に読み込むことは必須です。
それにはマニフェストファイルを「サイドロード」しろと書いてあるのですが、なかなか不親切で行き詰るところもあったので、情報をまとめてみます。
Officeの種類による違い
デスクトップ版とオンライン版でやり方が違います。
より簡単なのはオンライン版でしょう。
オンライン版に ...">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/yakuhanjp@3.0.0/dist/css/yakuhanrp.min.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/earlyaccess/mplus1p.css">
    
    <link rel="preload" href="/assets/css/0.styles.d2210da8.css" as="style"><link rel="preload" href="/assets/js/app.a299b07b.js" as="script"><link rel="preload" href="/assets/js/4.0c2c7e3b.js" as="script"><link rel="preload" href="/assets/js/5.f63c8c3d.js" as="script"><link rel="preload" href="/assets/js/36.a95f8700.js" as="script"><link rel="preload" href="/assets/js/7.4a8f97fb.js" as="script"><link rel="prefetch" href="/assets/js/1.6251d7ca.js"><link rel="prefetch" href="/assets/js/10.c41dcec4.js"><link rel="prefetch" href="/assets/js/11.a35a7b1b.js"><link rel="prefetch" href="/assets/js/12.fe55a3f5.js"><link rel="prefetch" href="/assets/js/13.f6122618.js"><link rel="prefetch" href="/assets/js/14.b85dbbcd.js"><link rel="prefetch" href="/assets/js/15.8712b0c2.js"><link rel="prefetch" href="/assets/js/16.872e4393.js"><link rel="prefetch" href="/assets/js/17.e51089e0.js"><link rel="prefetch" href="/assets/js/18.90017b97.js"><link rel="prefetch" href="/assets/js/19.b29cef02.js"><link rel="prefetch" href="/assets/js/20.852d3f5b.js"><link rel="prefetch" href="/assets/js/21.181398e0.js"><link rel="prefetch" href="/assets/js/22.2e594d13.js"><link rel="prefetch" href="/assets/js/23.e23bc94e.js"><link rel="prefetch" href="/assets/js/24.ab662614.js"><link rel="prefetch" href="/assets/js/25.82d44782.js"><link rel="prefetch" href="/assets/js/26.2befe4e6.js"><link rel="prefetch" href="/assets/js/27.613c8fb2.js"><link rel="prefetch" href="/assets/js/28.a645aaf4.js"><link rel="prefetch" href="/assets/js/29.24b1ce17.js"><link rel="prefetch" href="/assets/js/30.91785278.js"><link rel="prefetch" href="/assets/js/31.1ff1902d.js"><link rel="prefetch" href="/assets/js/32.b3b10c77.js"><link rel="prefetch" href="/assets/js/33.3d26557f.js"><link rel="prefetch" href="/assets/js/34.dcc7118a.js"><link rel="prefetch" href="/assets/js/35.3a7324d8.js"><link rel="prefetch" href="/assets/js/37.7aa72fff.js"><link rel="prefetch" href="/assets/js/38.e648fe00.js"><link rel="prefetch" href="/assets/js/39.87c4ce7c.js"><link rel="prefetch" href="/assets/js/40.a3ba24c2.js"><link rel="prefetch" href="/assets/js/41.cf971102.js"><link rel="prefetch" href="/assets/js/6.4edca310.js"><link rel="prefetch" href="/assets/js/8.5cd471fc.js"><link rel="prefetch" href="/assets/js/9.5f0d1f83.js"><link rel="prefetch" href="/assets/js/vuejs-paginate.4f9ec7c2.js">
    <link rel="stylesheet" href="/assets/css/0.styles.d2210da8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuepress-theme-blog__global-layout"><section id="header-wrapper"><header id="header"><div class="header-wrapper"><div class="title"><a href="/" class="nav-link home-link">ITブログ @ GB </a></div> <div class="header-right-wrap"><ul class="nav"><li class="nav-item"><a href="/column/" class="nav-link">小ネタ・小技</a></li><li class="nav-item"><a href="/pg/" class="nav-link router-link-active">プログラミング</a></li><li class="nav-item"><a href="/catovis/" class="nav-link">CATOVIS</a></li><li class="nav-item"><a href="/tag/" class="nav-link">タグ一覧</a></li></ul> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></div></header></section> <div id="mobile-header"><div class="mobile-header-bar"><div class="mobile-header-title"><a href="/" class="nav-link mobile-home-link">ITブログ @ GB </a> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></div> <div class="mobile-menu-wrapper"><hr class="menu-divider"> <ul class="mobile-nav"><li class="mobile-nav-item"><a href="/column/" class="nav-link">小ネタ・小技</a></li><li class="mobile-nav-item"><a href="/pg/" class="nav-link router-link-active">プログラミング</a></li><li class="mobile-nav-item"><a href="/catovis/" class="nav-link">CATOVIS</a></li><li class="mobile-nav-item"><a href="/tag/" class="nav-link">タグ一覧</a></li> <li class="mobile-nav-item"><!----></li></ul></div></div></div> <div class="content-wrapper"><div id="vuepress-theme-blog__post-layout"><div class="vuepress-blog-theme-content"><h1 class="post-title">マニフェストファイルのサイドロード</h1> <div class="post-meta"><div class="post-meta-author"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-navigation"><polygon points="3 11 22 2 13 21 11 13 3 11"></polygon></svg> 電氣羊 @ Goldenbridge
    <span>   in Osaka</span></div> <div class="post-meta-date"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg> 2020年01月17日
  </div> <ul class="post-meta-tags"><li class="post-tag" data-v-d832e844><a href="/tag/Office Add-in" data-v-d832e844> Office Add-in </a></li><li class="post-tag" data-v-d832e844><a href="/tag/JavaScript" data-v-d832e844> JavaScript </a></li><li class="post-tag" data-v-d832e844><a href="/tag/マニフェスト" data-v-d832e844> マニフェスト </a></li><li class="post-tag" data-v-d832e844><a href="/tag/連載" data-v-d832e844> 連載 </a></li></ul></div> <div class="content__default"><p>”Office Add-in”をつくるにあたって、開発用に読み込むことは必須です。</p> <p>それにはマニフェストファイルを「サイドロード」しろと書いてあるのですが、なかなか不親切で行き詰るところもあったので、情報をまとめてみます。</p> <h2 id="officeの種類による違い"><a href="#officeの種類による違い" class="header-anchor">#</a> Officeの種類による違い</h2> <p>デスクトップ版とオンライン版でやり方が違います。</p> <p>より簡単なのはオンライン版でしょう。</p> <h3 id="オンライン版にサイドロード"><a href="#オンライン版にサイドロード" class="header-anchor">#</a> オンライン版にサイドロード</h3> <p>オンライン版の場合の手順は次のとおりです。</p> <ol><li>ファイルを開く</li> <li>「挿入」をクリック</li> <li>「アドイン」をクリック</li> <li>「個人用アドインの管理」をクリック</li> <li>「マイアドインのアップロード」をクリック</li></ol> <p>上記の手順で、アップロード用のダイアログを出すことができます。</p> <p>あとはXMLファイルを選ぶだけでサイドロードは完了です。オンラインのWordに新しい機能を追加することができます。</p> <p>また、開発用サーバー（localhost）でも、きちんとマニフェストに記述してあれば開くことができました。</p> <p>VBA（マクロ）の使えないオンライン版Wordでも、自動化の道が開けるかもしれません。</p> <h3 id="オンライン版officeからアンインストール"><a href="#オンライン版officeからアンインストール" class="header-anchor">#</a> オンライン版Officeからアンインストール</h3> <p>ちなみに。。。</p> <p>「きちんとアンインストールできるのか」という点も、開発中は気になりますよね。</p> <p>これも情報が少なくて苦労しました。</p> <p>なにせ、</p> <p><strong>「ストアに並んでいるAdd-in」</strong> と <strong>「サイドロードしたAdd-in」</strong> はアンインストールの方法が<strong>違う</strong>のです。</p> <p>前者の場合は、「個人用アドインの管理」から「マイアカウント」に入ることでアンインストールすることができます。ところが後者は、「マイアカウント」の画面にも出てきません。</p> <p>一体どこにあるのか……</p> <p>と探し回ったところ、ついに見つけました。</p> <p>なんと、サイドロードしたマニフェストファイルは「ブラウザのキャッシュ」として保存されているのだとか！</p> <p>なので、ブラウザのキャッシュをクリアしてあげることで、無事、アンインストールすることができました。</p> <h3 id="デスクトップ版にサイドロード"><a href="#デスクトップ版にサイドロード" class="header-anchor">#</a> デスクトップ版にサイドロード</h3> <p>さて、次が本命。デスクトップ版にサイドロードする方法です。</p> <p>これには何種類か方法があります。</p> <ul><li>CLIを使う</li> <li>Wordのセキュリティセンターから設定する</li> <li>レジストリをいじる</li></ul> <p>順番に行きましょう。</p> <h4 id="cliを使う"><a href="#cliを使う" class="header-anchor">#</a> CLIを使う</h4> <p>まずはCLIを使う方法。</p> <p>これは「マニフェストファイルをつくる」で説明した方法で、</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code>npm <span class="token function">start</span>
</code></pre></div><p>と打ち込んで実行する方法です。</p> <p>npmを使って環境を準備しているときは一番手っ取り早い方法です。</p> <p>ただし、CLIから開かれるファイルでしか使えないので、少し不便もあります。</p> <h4 id="wordのセキュリティセンターから設定する"><a href="#wordのセキュリティセンターから設定する" class="header-anchor">#</a> Wordのセキュリティセンターから設定する</h4> <p>次にWordのセキュリティセンターから設定する方法。</p> <p>これが公式ドキュメントに書かれている方法です。</p> <p>https://docs.microsoft.com/ja-jp/office/dev/add-ins/testing/create-a-network-shared-folder-catalog-for-task-pane-and-content-add-ins</p> <p>この方法を使えば、共有フォルダをつくるだけでサイドロードが完了します。</p> <p>また、共有フォルダには複数のマニフェストファイルを入れることができます。</p> <p>平行して複数の開発が進行している場合などは、まとめて入れておくといいでしょう。</p> <p>さらに、実は共有フォルダと似た機能でも実現できます。</p> <p>例えば、Sambaを使ってファイルサーバーを作ったり、NASのファイルパスも受け付けてくれました。</p> <p>この方法は、一度オプションで設定しておけば、マニフェストの管理（追加／削除）が楽になるのがメリットです。</p> <p>ただ、共有フォルダの場所を変えたいときはWordの再起動が必要になります。</p> <h4 id="レジストリをいじる"><a href="#レジストリをいじる" class="header-anchor">#</a> レジストリをいじる</h4> <p>最後に、レジストリをいじる方法も紹介します。</p> <p>前回、少し触れましたが、CLIからの読み込みは、どうやらレジストリを変更している個所があるようです。</p> <p>その設定は、取っておいたエラー出力を見てみましょう。</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token string">&quot;C:\My Office Add-in\manifest.xml&quot;</span> in key <span class="token string">&quot;HKCU\SOFTWARE\Microsoft\Office\16.0\Wef\Developer&quot;</span><span class="token punctuation">.</span>
</code></pre></div><p>ですね。</p> <p>このレジストリキーに、マニフェストのファイルパスを設定してやれば、Wordを立ち上げるたびにマニフェストを読み込んでくれます。</p> <p>レジストリをいじるときは必ずバックアップを取りましょう！ <strong>自己責任！</strong></p> <p>サイドロードとアンインストールを知って、より良いOffice Add-inライフを！</p> <div id="linkToGB"><img src="/logo_header.png"> <p>ゴールデンブリッジでは、<br>
    翻訳・通訳・インバウンドツアー・国際会議運営など<br>
    ご用命をお待ちしております！<br>
    また、翻訳に関わるツール・ソフトウェアの開発等についてもお気軽にお声掛けください。</p> <a href="http://goldenbridge2002.com/" target="_blank">株式会社ゴールデンブリッジ　公式Webサイト</a></div></div> <!----> <hr> <!----></div> <div class="sticker vuepress-toc"><div class="vuepress-toc-item vuepress-toc-h2 active"><a href="#officeの種類による違い" title="Officeの種類による違い">Officeの種類による違い</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#オンライン版にサイドロード" title="オンライン版にサイドロード">オンライン版にサイドロード</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#オンライン版officeからアンインストール" title="オンライン版Officeからアンインストール">オンライン版Officeからアンインストール</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#デスクトップ版にサイドロード" title="デスクトップ版にサイドロード">デスクトップ版にサイドロード</a></div></div></div></div> <footer class="footer" data-v-582f9766><div class="footer-left-wrap" data-v-582f9766><ul class="contact" data-v-582f9766><li class="contact-item" data-v-582f9766><a href="http://www.goldenbridge2002.com" target="_blank" rel="noopener noreferrer" class="nav-link external" data-v-582f9766><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-globe" data-v-582f9766><circle cx="12" cy="12" r="10" data-v-582f9766></circle><line x1="2" y1="12" x2="22" y2="12" data-v-582f9766></line><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z" data-v-582f9766></path></svg>
          
        </a></li></ul></div> <div class="footer-right-wrap" data-v-582f9766><ul class="copyright" data-v-582f9766><li class="copyright-item" data-v-582f9766><a href="/privacy.html" class="nav-link" data-v-582f9766>プライバシーポリシー</a></li><li class="copyright-item" data-v-582f9766><a href="http://www.goldenbridge2002.com" target="_blank" rel="noopener noreferrer" class="nav-link external" data-v-582f9766>Copyright © 2020 Goldenbridge Inc.</a></li></ul></div></footer></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.a299b07b.js" defer></script><script src="/assets/js/4.0c2c7e3b.js" defer></script><script src="/assets/js/5.f63c8c3d.js" defer></script><script src="/assets/js/36.a95f8700.js" defer></script><script src="/assets/js/7.4a8f97fb.js" defer></script>
  </body>
</html>
