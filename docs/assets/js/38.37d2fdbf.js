(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{317:function(v,_,t){"use strict";t.r(_);var a=t(5),s=Object(a.a)({},(function(){var v=this,_=v.$createElement,t=v._self._c||_;return t("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[t("p",[v._v("”Office Add-in”をつくるにあたって、開発用に読み込むことは必須です。")]),v._v(" "),t("p",[v._v("それにはマニフェストファイルを「サイドロード」しろと書いてあるのですが、なかなか不親切で行き詰るところもあったので、情報をまとめてみます。")]),v._v(" "),t("h2",{attrs:{id:"officeの種類による違い"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#officeの種類による違い"}},[v._v("#")]),v._v(" Officeの種類による違い")]),v._v(" "),t("p",[v._v("デスクトップ版とオンライン版でやり方が違います。")]),v._v(" "),t("p",[v._v("より簡単なのはオンライン版でしょう。")]),v._v(" "),t("h3",{attrs:{id:"オンライン版にサイドロード"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#オンライン版にサイドロード"}},[v._v("#")]),v._v(" オンライン版にサイドロード")]),v._v(" "),t("p",[v._v("オンライン版の場合の手順は次のとおりです。")]),v._v(" "),t("ol",[t("li",[v._v("ファイルを開く")]),v._v(" "),t("li",[v._v("「挿入」をクリック")]),v._v(" "),t("li",[v._v("「アドイン」をクリック")]),v._v(" "),t("li",[v._v("「個人用アドインの管理」をクリック")]),v._v(" "),t("li",[v._v("「マイアドインのアップロード」をクリック")])]),v._v(" "),t("p",[v._v("上記の手順で、アップロード用のダイアログを出すことができます。")]),v._v(" "),t("p",[v._v("あとはXMLファイルを選ぶだけでサイドロードは完了です。オンラインのWordに新しい機能を追加することができます。")]),v._v(" "),t("p",[v._v("また、開発用サーバー（localhost）でも、きちんとマニフェストに記述してあれば開くことができました。")]),v._v(" "),t("p",[v._v("VBA（マクロ）の使えないオンライン版Wordでも、自動化の道が開けるかもしれません。")]),v._v(" "),t("h3",{attrs:{id:"オンライン版officeからアンインストール"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#オンライン版officeからアンインストール"}},[v._v("#")]),v._v(" オンライン版Officeからアンインストール")]),v._v(" "),t("p",[v._v("ちなみに。。。")]),v._v(" "),t("p",[v._v("「きちんとアンインストールできるのか」という点も、開発中は気になりますよね。")]),v._v(" "),t("p",[v._v("これも情報が少なくて苦労しました。")]),v._v(" "),t("p",[v._v("なにせ、")]),v._v(" "),t("p",[t("strong",[v._v("「ストアに並んでいるAdd-in」")]),v._v(" と "),t("strong",[v._v("「サイドロードしたAdd-in」")]),v._v(" はアンインストールの方法が"),t("strong",[v._v("違う")]),v._v("のです。")]),v._v(" "),t("p",[v._v("前者の場合は、「個人用アドインの管理」から「マイアカウント」に入ることでアンインストールすることができます。ところが後者は、「マイアカウント」の画面にも出てきません。")]),v._v(" "),t("p",[v._v("一体どこにあるのか……")]),v._v(" "),t("p",[v._v("と探し回ったところ、ついに見つけました。")]),v._v(" "),t("p",[v._v("なんと、サイドロードしたマニフェストファイルは「ブラウザのキャッシュ」として保存されているのだとか！")]),v._v(" "),t("p",[v._v("なので、ブラウザのキャッシュをクリアしてあげることで、無事、アンインストールすることができました。")]),v._v(" "),t("h3",{attrs:{id:"デスクトップ版にサイドロード"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#デスクトップ版にサイドロード"}},[v._v("#")]),v._v(" デスクトップ版にサイドロード")]),v._v(" "),t("p",[v._v("さて、次が本命。デスクトップ版にサイドロードする方法です。")]),v._v(" "),t("p",[v._v("これには何種類か方法があります。")]),v._v(" "),t("ul",[t("li",[v._v("CLIを使う")]),v._v(" "),t("li",[v._v("Wordのセキュリティセンターから設定する")]),v._v(" "),t("li",[v._v("レジストリをいじる")])]),v._v(" "),t("p",[v._v("順番に行きましょう。")]),v._v(" "),t("h4",{attrs:{id:"cliを使う"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#cliを使う"}},[v._v("#")]),v._v(" CLIを使う")]),v._v(" "),t("p",[v._v("まずはCLIを使う方法。")]),v._v(" "),t("p",[v._v("これは「マニフェストファイルをつくる」で説明した方法で、")]),v._v(" "),t("div",{staticClass:"language-powershell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-powershell"}},[t("code",[v._v("npm "),t("span",{pre:!0,attrs:{class:"token function"}},[v._v("start")]),v._v("\n")])])]),t("p",[v._v("と打ち込んで実行する方法です。")]),v._v(" "),t("p",[v._v("npmを使って環境を準備しているときは一番手っ取り早い方法です。")]),v._v(" "),t("p",[v._v("ただし、CLIから開かれるファイルでしか使えないので、少し不便もあります。")]),v._v(" "),t("h4",{attrs:{id:"wordのセキュリティセンターから設定する"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#wordのセキュリティセンターから設定する"}},[v._v("#")]),v._v(" Wordのセキュリティセンターから設定する")]),v._v(" "),t("p",[v._v("次にWordのセキュリティセンターから設定する方法。")]),v._v(" "),t("p",[v._v("これが公式ドキュメントに書かれている方法です。")]),v._v(" "),t("p",[v._v("https://docs.microsoft.com/ja-jp/office/dev/add-ins/testing/create-a-network-shared-folder-catalog-for-task-pane-and-content-add-ins")]),v._v(" "),t("p",[v._v("この方法を使えば、共有フォルダをつくるだけでサイドロードが完了します。")]),v._v(" "),t("p",[v._v("また、共有フォルダには複数のマニフェストファイルを入れることができます。")]),v._v(" "),t("p",[v._v("平行して複数の開発が進行している場合などは、まとめて入れておくといいでしょう。")]),v._v(" "),t("p",[v._v("さらに、実は共有フォルダと似た機能でも実現できます。")]),v._v(" "),t("p",[v._v("例えば、Sambaを使ってファイルサーバーを作ったり、NASのファイルパスも受け付けてくれました。")]),v._v(" "),t("p",[v._v("この方法は、一度オプションで設定しておけば、マニフェストの管理（追加／削除）が楽になるのがメリットです。")]),v._v(" "),t("p",[v._v("ただ、共有フォルダの場所を変えたいときはWordの再起動が必要になります。")]),v._v(" "),t("h4",{attrs:{id:"レジストリをいじる"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#レジストリをいじる"}},[v._v("#")]),v._v(" レジストリをいじる")]),v._v(" "),t("p",[v._v("最後に、レジストリをいじる方法も紹介します。")]),v._v(" "),t("p",[v._v("前回、少し触れましたが、CLIからの読み込みは、どうやらレジストリを変更している個所があるようです。")]),v._v(" "),t("p",[v._v("その設定は、取っておいたエラー出力を見てみましょう。")]),v._v(" "),t("div",{staticClass:"language-powershell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-powershell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token string"}},[v._v('"C:\\My Office Add-in\\manifest.xml"')]),v._v(" in key "),t("span",{pre:!0,attrs:{class:"token string"}},[v._v('"HKCU\\SOFTWARE\\Microsoft\\Office\\16.0\\Wef\\Developer"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[v._v(".")]),v._v("\n")])])]),t("p",[v._v("ですね。")]),v._v(" "),t("p",[v._v("このレジストリキーに、マニフェストのファイルパスを設定してやれば、Wordを立ち上げるたびにマニフェストを読み込んでくれます。")]),v._v(" "),t("p",[v._v("レジストリをいじるときは必ずバックアップを取りましょう！ "),t("strong",[v._v("自己責任！")])]),v._v(" "),t("p",[v._v("サイドロードとアンインストールを知って、より良いOffice Add-inライフを！")]),v._v(" "),t("link-to")],1)}),[],!1,null,null,null);_.default=s.exports}}]);