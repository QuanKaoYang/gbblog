---
title: 下層ファイルをフォルダにまとめる
slug: ps_003
date: 2020-01-01
tags:
    - コマンドレット
    - 使用例 
    - ファイル操作
author: S.I. @ Goldenbridge
location: Osaka
---

章立ての複雑な原稿をもらったとき。
章ごとにフォルダを分けるのはまだいいとして、節ごとにフォルダが分けられているのは、なかなか大変ですよね。

一括処理をするためにも、全ファイルを一時的に1つのフォルダにまとめたくなります。
そんなときはPowerShellで簡単に解決！

```powershell
mkdir ../temp
Get-Childitem -Recurse -File | Copy-Item -Destination ../temp
```

注意するべきは、原稿と同じフォルダ（もしくは同じフォルダの中のフォルダ）にまとめ用の一時フォルダを作らないこと。
-Recurseオプションをつけて再帰的にコピーしていくため、順番によってはコピーしたファイルもコピー対象となって、「上書きできない」、とエラーになってしまいます。
（実はこれで少しハマった）

上記の例では、探索させる層よりも上のディレクトリ（../）にフォルダを作っています。
また、エイリアスを駆使した最短バージョンも載せておきます。 

```powershell
mkdir ../temp
ls -re -file | cp -d ../temp
```

これなら一括置換マクロなども楽々実行できますね。

<link-to></link-to>